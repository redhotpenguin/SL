#!/usr/bin/env perl

use strict;
use warnings;

my $perlbal = "/usr/local/bin/perl /usr/local/bin/perlbal -d";

unless ( _is_perlbal_running()) {
    # uh oh, houston we have a problem
    warn("$$ Uh oh, perlbal is not running.  Trying to start it...");

    my $start = `$perlbal`; 
    
    if ( my $running = _is_perlbal_running()) {
        warn("perlbal was started ok: $running");
	exit(0);
    } else {
    	warn("Perlbal could not be started, giving up.  ALERT ALERT!");
    }

}

sub _is_perlbal_running {

	my $is_perlbal_running = `pgrep perlbal`;
	chomp($is_perlbal_running);

	return if ($is_perlbal_running eq '');

	return $is_perlbal_running;
}


