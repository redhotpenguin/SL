#!/usr/bin/env perl

use strict;
use warnings;

require SL::Maintd;

my $hostname = 'herbert';
my $admin = 'fred@redhotpenguin.com';
my $maintd = SL::Maintd->new;
my %report;

foreach my $status qw( uptime ip dns ping tunnel ) {
    $report{$status} = $maintd->$status;
}

require Mail::Mailer;

my $mailer = Mail::Mailer->new( 'qmail');

$mailer->open({
    From    => "$hostname\@redhotpenguin.com",
    To      => $admin,
    Subject => uc($hostname) . " Status Report"
    }
);

require Data::Dumper;

my $body = "Maintd report ran at " . time() . "\n\n" . 
    Data::Dumper::Dumper(\%report);
print $mailer $body;
$mailer->close;
