[% PROCESS header.tmpl %]
[% PROCESS left.tmpl %]

<div id="list_center">
	<div class="content">

<h2>[% PROCESS ad/groups/nav.tmpl %] > 
[% UNLESS ad_group.ad_group_id  %]Create a New Ad Group[% ELSE %]Edit an Existing Ad Group[% END %]</h2>
<hr size=1 color="#CCCCCC">
<div id="edit_form">

<table class="edit"> 

<tr><td colspan=2>
[% IF ad_group.ad_group_id %]
	<h2>You are Editing Ad Group '[% ad_group.name %]'</h2>
[% ELSE %]
<h2>You are creating a new Ad Group</h2></td></tr>
[% END %]

[% IF status == 'update_ok' %]
<p><font color="red">Your Ad Group has been updated.</font></p>
[% END %]

[% IF errors.missing %]
<p><font color="red">Please fill in the missing fields</font></p>
[% END %]
[% IF errors.invalid %]
<p><font color="red">Some fields were invalid, please correct them</font></p>
[% END %]
<tr><td colspan=2><hr size=1 color="#CCCCCC"></td></tr>

<form method="POST" action="[% base_uri %]/app/ad/groups/edit">

<!-- name -->
<tr><td>[% IF errors.missing.name %]<font color="red">[% END %]
Ad Group name:
[% IF errors.missing.name %]</font>[% END %]</td>
<td><input type="text" name="name" size="50" maxlength="100" value='[% req.param('name') or ad_group.name %]'>
</td></tr>
<tr><td colspan=2><font color="#CCCCCC">(100 character limit)</font></td></tr>
<!-- /name -->

<tr><td colspan=2><hr size=1 color="#CCCCCC"></td></tr>

<!-- bug selection -->
<tr>
<td colspan="2"><table>
<tr>
<td colspan="[% bugs.max %]">
[% IF errors.missing.bug_id %]<font color="red">[% END %]
Select a bug to associate the ad group with:
[% IF errors.missing.bug_id %]</font>[% END %]
</td></tr>
<tr>
[% FOREACH bug = bugs %]
<td><img src="[% bug.image_href %]"></td>
[% END %]
</tr>
<tr>
[% FOREACH bug = bugs %]
<td><input type="radio" name="bug_id" 
value="[% bug.bug_id %]"
[% IF (req.param('bug_id') == bug.bug_id ) %]checked
[% ELSIF (ad_group.bug_id.bug_id == bug.bug_id) %]checked[% END %]>
&nbsp;[% bug.name %]</td>
[% END %]
</tr>
</table>
</td></tr>
<tr><td colspan=3><font color="#CCCCCC">
<a href="[% base_uri %]/app/ad/bugs/index">Add a new Bug</a>
</font></td></tr>

<!-- end bug selection -->

<tr><td colspan=2><hr size=1 color="#CCCCCC"></td></tr>

<!-- friends -->
[% IF ad_group.ad_group_id %]
<tr><td colspan="2">This Ad Group was created by <b>[% ad_group.reg_id.email %]</b></td></tr>
[% END %]

[% UNLESS friends %]

<tr><td colspan="4"><a href="[% base_uri %]/app/settings/friends">
Set up other users to share permissions</a></td></tr>

[% ELSIF friends %]

<tr><td colspan="2">Users who have access to this Ad Group:</td></tr>
<tr><td colspan="4">
[% FOREACH friend = friends %]
    <input [% IF ad_group.reg_id.reg_id != reg.reg_id %]disabled="1"[% END %]type="checkbox" name="friends" value="[% friend.reg_id %]" [% IF friend.selected %]CHECKED[% END %]>
[% friend.email %]&nbsp;&nbsp;
[% END %]
</td></tr>
<tr><td colspan=4><font color="#CCCCCC">
Click checkbox to give users access to this ad</font></td></tr>

[% END %]
<tr><td colspan=2><hr size=1 color="#CCCCCC"></td></tr>

<!-- active -->
<tr><td>Active:</font></td><td>
Yes<input type="radio" name="active" value="t" [% IF (ad_group.active == 1) or (! ad_group) %]checked[% END %]>&nbsp;
No<input type="radio" name="active" value="f" [% IF ad_group.active == 0 %] checked [% END %]></td></tr>
<tr><td colspan=3><font color="#CCCCCC">
Deactivating the ad group removes it from the ad serving rotation.<br />To ensure consistency in reporting, ad groups cannot be deleted.
</font></td></tr>

<!-- end active -->

<tr><td colspan=2><hr size=1 color="#CCCCCC"></td></tr>

<tr><td><input type="submit" value="Save Ad Group"></td></tr>
<input type="hidden" name="id" value="[% ad_group.ad_group_id %]">
</form>

</table>
</div>
</div>
</div>

[% PROCESS footer.tmpl %]
